# **🌎Born2beroot🌎**

## **가상머신(Virtual Machine)**

- 가상머신이란?
- 물리적으로 1대인 컴퓨터에서 마치 여러 대의 컴퓨터로 운영하는 것과 같은 환경을 제공해주는 소프트웨어
- 가상 머신의 종류는 프로세스 가상 머신과 시스템 가상 머신이 있다.
- 과제에서는 시스템 가상 머신에 해당이된다.
- 가상머신상에서 `운영체제` 설치가능.

```c
subject에서 Virtual Box나 UTM을 사용하라고 명시
그래서 Virtual Box를 사용하려고 했지만, m1노트북에서는
현재 지원을 해주지않아 노트북으로 하려면 UTM으로 해야했다.
virtual Box로 하는게 더편할것 같아 클러스터에 나가서 과제 진행
```

## Virtual Box 설치 및 Debian설치

---

- 설치할때 유의 할점

  - 데이터 용량 문제때문에 goinfre에다가 설치해야한다.
  - goinfre 폴더는 각 아이맥의 로컬저장소라고 알고있다.

- 데비안(Debian)과 센토스(CentOS)

  - 데비안(Debian)
    - 데스크탑 및 서버를 비롯한 광범위한 장치를 위한 운영체제이다.
    - 자유소프트웨어(공짜)
    - 많은 배포판의 기반(우분투OS의 기반)
    - 리눅스 커널탑재//커널 = 자동차(OS)로 치면 엔진(커널)
    - 안정성과 보안이 우수하다.
  - 센토스(CentOS)
    - RHEL(레드헷 엔터프라이즈 리눅스)에서 파생된 리눅스의 배포판중 하나

```c
리눅스란 ?

쉽게 말하자면, 윈도우와 같은 하나의 독자적인 컴퓨터 운영체제(OS)이다.
(OS란, 컴퓨터의 하드웨어와 소프트웨어를 제어하여, 사용자가 컴퓨터를 쓸 수 있게 만들어주는 프로그램을 말한다.)

리눅스는 공개 소프트웨어라서 그룹이나 회사등에서 커널소스를 받아 OS를 직접제작하여 사용된다.

배포된 리눅스의 종류

데비안 (Debian)
패키지설치 및 업그레이드가 단순하여 간편한 장점이 있음.
안정성과 보안에 중점을 두고 있음

우분투 (ubuntu)
Debian을 기반으로 하여 만들어짐.
windows에 익숙해진 유저들이 리눅스를 쉽게 접할 수 있도록 만들어진 운영체제.

레드 햇 (red hat)
클라우드 인프라구축이 쉽고 간편함.

안드로이드 (android)
구글에서 리눅스를 기반으로 개발한 운영체제로, c, c++, python, java등의 프로그래밍 언어를 지원함.
```

데비안 설치과정

- GUI 설치안함

- Debian은 AppArmor, CentOS는 SELinux를 시작 시에 구동 ✔️

- LVM를 사용해서 암호화된 파티션을 2개 이상 생성해야 한다.

---

## 선행지식

#### AppArmor & SELinux

- 두개 다 Security framework이며, LSM(Linux Security Module)을 기반으로 구현됨
- 둘다 보안 모델 MAC 적용
- 기존 리눅스는 DAC (임의 접근제어) 적용

```c
MAC (Mandatory Access Control)
강제적 접근 제어 모델
중앙에서 정보를 수집하고 분류하여, 각각의 보안 레벨을 붙이고
이에 대해 정책적으로 접근 제어를 수행한다.

DAC (Discretionary Access Control)
임의적 접근제어 방식은 자원의 소유자 혹은 관리자가 보안관리자의 개입없이 자율적 판단에 따라 접근권한을 다른 사용자에게 부여하는 기법을 말한다
```

- AppArmor
  - Application Armor의 약자
  - 시스템 관리자가 프로그램 프로필 별로 프로그램의 역량을 제한할 수 있게 해주는 리눅스 커널 보안 모듈이다.

```c
커널이란 ?

 하드웨어와 응용 프로그램 사이에서 인터페이스를 제공하여 응용 프로그램이 하드웨어에서부터 오는 자원을 관리하고 사용 할 수 있게 해준다.
 구체적으로 말하면, 커널이란 운영체제(OS)에서 가장 중요한 구성요소로서, 입출력을 관리하고 소프트웨어로부터 요청(System Call)을 컴퓨터에 있는 하드웨어(CPU, 메모리, 저장장치, 모니터)가 처리할 수 있도록 요청(System Call)을 변환하는 역할을 한다.
( User는 Shell을 이용하여 Kernel을 통해 하드웨어를 사용 할 수 있다. )

모듈이란 ?
소프트웨어 설계에서 기능단위로 분해하고 추상화 되어 재사용 및 공유 가능한 수준으로 만들어진 단위

출처 : http://itnovice1.blogspot.com/2019/08/blog-post_83.html
```

- "aa-enabled" 명령어 : 앱아머 활성화 여부 확인 가능
- 정책 파일을 통해 어떤 어플리케이션이 어떤 파일/경로에 접근하는지 관리
- `enforce모드`와 `complain모드` 두 가지 존재
  - **enforce 모드** : 허가되지 않은 파일에 `접근`하는 것을 `거부`하는 모드
  - **complain 모드** : 실질적으로 보안을 제공하는 것은 아님. 대신 어플리케이션이 해야 할 행동이 아닌 다른 행동을 하는 경우에 앱아머는 `로그`를 남겨준다(중지하지는 않음).
  - `"sudo aa-status"`통해 현재 상태 확인 가능(**enforced**, **complain**, **unconfined**)
- SUSE 계열 (SUSE Linux), 데비안 계열 (Debian, Ubuntu)
- 개별 응용 프로그램을 보호하는 일에 집중
- 응용 프로그램 단위의 보안 모델 구현
- AppArmor는 SELinux를 대체하는 한 부분으로서 제공

---

- SSH 서비스는 4242 포트에서만 실행된다. 보안상의 이유로 SSH를 root로 사용해서 연결하는 것은 금지돤다.
- ssh가 어떻게 작동하는지 알고 있어야 한다.
- UFW 방화벽을 이용해야하고 4242포트만 열어놔야한다.
- 방화벽은 가상머신을 시작할때 작동해야한다. centOS에서 기본방화벽 대신에 UFW방화벽을 이용해야 한다. 설치하기 위해서는 DNF가 필요할듯
- 강한 암호 폴리시를 구현해야합니다.
- root 유저 외에도 `[당신의 로그인]`이 유저네임인 유저가 존재해야 합니다.
- 평가 중에 새 유저를 생성해서 그룹에 할당해야 합니다.

- 강한 암호를 셋업하기 위해, 다음 요구 사항을 준수해야 합니다.

```c
1. password 는 30일마다 만료되어야한다.
2. 비밀번호 최소 사용일이 2일 이다 (비밀번호 변경후 2일이 지나야 다시변경 가능)
3. 유저는 비밀번호 만료 7일전에 경고 메세지를 받아야 한다.
4. 비밀번호는 최소 10자리여야 한다. 영어 대문자 + 숫자는 꼭 포함하고 있어야 한다. 3개 이상의 연속된 동일한 문자를 가지면 안된다.
5. 비밀번호는 사용자의 이름을 포함하면 안된다.
6. 비밀번호는 이전의 비밀번호와 다른 최소 7글자를 가져야 한다.
7. 당연히 root password는 이 정책을 따라야한다.
8. 구성 file을 셋팅한 후, 가상머신에 존재하는 모든 계정의 비밀번호를 바꿔야 한다. 루트계정 포함.
```

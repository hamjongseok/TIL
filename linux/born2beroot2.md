# **🌎Born2beroot🌎**

## **sudo**

- Super User Do의 줄임말
- UNIX에서는 root계정만이 모든 명령을 실행, 특정한 중요작업을 수행할수있다.
- sudo명령어를 통해 다른 일반 사용자가 일부 명령을 실행하고 시스템 작업을 수행할 수 있도록 허용해준다.

---

```c
sudo 관련 명령어

dpkg -l sudo (설치여부 확인)

apt install sudo (수도설치)

su - (root계정으로 이동)

sudo (명령어)
일반유저가 root권한으로 명령어 실행

su (계정명)
현재 유저를 로그아웃 하지않은 채로 다른 사용자 계정으로 전환

visudo (sudoer파일 접근)

```

---

### subject 항목

- 비밀번호 오류는 3번으로 제한됩니다. ⭕️

  - `passwd_tries=3`

- sudo를 사용할 때, 잘못 된 암호로 인한 오류가 발생할 경우 커스텀 메시지를 표시합니다. ⭕️

  - `badpass_message=""`
  - Defaults authfail_message="원하는 에러메세지" #권한 획득 실패 시 출력 (sudo 인증 실패 시,3번의 비번 틀릴경우)

- sudo를 사용할 때의 모든 입출력 동작은 기록되어야 합니다. 로그 파일은 `/var/log/sudo/` 폴더에 저장됩니다. ⭕️
  - `iolog_dir="/var/log/sudo/"` (로그 저장할 경로)
- sudo를 이용한 action들은 input 과 output이 archived(모여있어야함)⭕️

  - Defalt log_input : sudo를 통해 입력된 input은 로그에 기록된다.
  - Defalt log_output : sudo를 통해 입력된 output은 로그에 기록된다

  ```c
  log 파일이란 ?
  - 컴퓨터의 모든 사용내역을 기록하고 있는 파일을 말한다.
  - 해킹 등의 사건이 발생했을때, 로그파일을 분석하여 사건의 원인을 파악한다.
  ```

- 보안 문제 관련해서, TTY 모드를 활성화합니다.⭕️
  - `requiretty` (tty환경에서만 sudo 명령이 실행될 수 있도록 한다.)

```c
  TTY (Teletypewriter)

  콘솔의 한 종류로 Ctrl-Alt-F1 ~ F6 키조합으로 사용할수있는 OS 에서 제공하는 가상콘솔 이다. 실제 물리적인 장치가 연결된것이 아니기 때문에 커널에서 터미널을 emulation 한다. TTY화면간 이동은 ALT+F1~F6이며 GUI환경 복귀는 ALT+F7이다.

출처: https://booolean.tistory.com/666 [Boolean]

콘솔이란 ?
CLI 혹은 CUI라고 불리며 컴퓨터를 운용하기 위한 목적으로 테스트를 사용자와 주고 받는 방식의 인터페이스를 말한다.

```

- 보안 문제 관련해서, sudo에서 사용할 수 있는 경로는 제한됩니다. ⭕️
  - `secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"`

```c
  sudo명령 실행 시 현재 계정의 쉘이 아닌 새로운 쉘을 생성하고 그 안에서 명령을 실행하는데, 이 때 명령을 찾을 경로를 나열한 환경변수인 PATH값이 secure_path

  shell 명령어들은 PATH 환경변수에 지정된 경로에서 바이너리 파일을 찾는다.

 sudo 권한이 있는 사용자의 PATH 환경변수에 악성코드로 인한 경로가 포함되어 있어 특정 명령 실행시 해당 경로에서 악성 파일이 실행될 경우 유저가 sudo를 통해 시스템 전반에 대한 권한을 부여받은 채 해당 명령을 실행한다면 시스템에 큰 문제가 생길 것이다.

이러한 상황을 방지하기 위해 sudo 가 실행되는 가상 쉘에서 명령어의 바이너리 파일 경로를 secure_path 로 제한하는 것이다.
```

---

## Group

- 이 사용자는 user42 와 sudo 그룹에 속해야 합니다 ⭕️
  - groupadd user42 명령어를 통해 user42그룹 추가
  - usermod -aG sudo,user42 <사용자이름> 명령어를 통해 해당 그룹에 유저를 추가

```c
G 옵션:
G옵션만 붙힌 상태에서 그룹 설정 시, 명령어에 나열된 그룹만 추가가 되며 명령어에 나열되어 있지 않지만 유저가 속해있는 그룹은 전부 탈퇴된다.

a 옵션:
G옵션에서만 함께 쓰일 수 있고, G옵션만 붙었을 때와 달리, 유저가 속해있지만 명령어에 나열되어있지 않는 그룹에 관하여 탈퇴처리 되지 않는다.

"sudo deluser 사용자명 그룹명"을 통해 그룹에서 사용자를 제거할 수 있다.

"sudo userdel -r 사용자명" 통해 사용자 제거 가능.
```

- id jham (어느 그룹에 속해있는지 나온다.)

---

## `UFW`

- 방화벽이란 ?
  - 외부 사용자(WAN)들이 내부 네트워크(LAN)에 접근하지 못하도록 하는 일종의 내부 네트워크 방어도구이다.
  - 방화벽은 신뢰할 수 있는 내부 네트워크, 신뢰할 수 없는 외부 네트워크 간의 장벽을 구성한다.
  - 서로 다른 네트워크를 지나는 데이터를 허용 또는 거부 하거나 검열 또는 수정하는 하드웨어 또는 소프트웨어다.
- UFW ?
  - Uncomplicated Firewall의 약자
  - Debian 계열 및 다양한 리눅스 환경에서 작동되는 사용하기 쉬운 방화벽 관리 프로그램
  - UTF는 손쉬운 조작으로 iptable 및 사슬 설정을 대신해준다.(Uncomplicated: 복잡하지 않은) 데비안의 기본 방화벽은 iptable이다.
  - iptable이란?
    - 시스템관리자가 리눅스 커널 방화벽이 제공하는 테이블과 그것들을 저장하는 체인, 규칙들을 구성할 수 있게 해주는 사용자 공간 응용프로그램

```
평가때 사용하는 명령어

ufw enable: 방화벽 활성화

ufw status: 방화벽 상태를 확인

ufw delete (규칙 번호): 정의된 특정 번호의 규칙 제거

ufw allow (포트넘버): 특정 포트넘버 접속 허용

ufw deny (포트넘버): 특정 포트넘버 접속 제한
```

---

## SSH

- Secure Shell Protocol
- 원격 호스트에 접속하기 위해 사용되는 보안 프로토콜
- 대표적인 사용

  - 데이터 전송 (깃 푸시)
  - 원격제어 (aws같은 클라우드 서비스)

- port 4242를 열어놨는데, 22일때만 접속을 할수있고 에러가 발생한다.
  자리 오류인건가? 자리 옮겨서 내일은 꼭 ssh 성공하길 기원합니다
